
# 所有权

在 Rust 中，每个值有且只有一个属主／拥有者。后者决定前者何时被释放，当后者被释放
（dropped）后，该值也同时被释放。

除此之外，Rust 还有一些别的操作：
- 可以将值从一个变量移到另一个变量上，用于重新安排
- 标准库提供了引用计数容器，Rc及 Arc，这样多个变量可以拥有一个值；当最后一个变量
被释放后，它们拥有的值也会被释放
- 可以使用 borrow reference（借用），引用并不会改变值的拥有者

一个资源只能一个所有者, 但可以有多个引用(reference)指向它.
`let x = y;`, `foo(x)` 当进行赋值及作为函数参数时, 变量的所有权就进行了传递.

传递所有权时, 可以更改值的可变性:
```rust
let x = Box::new(42i32);
let mut x2 = x;
```

## RAII
`Drop` trait 类似于 C++ 中的 `destructor`, 用于实现 `RAII` 模式, 它管理的是
栈上的内存.

## 转移
大多数类型，在赋值、函数参数及函数返回值时，都是 move 的方式，而不是拷贝的方式。
原变量的值的所有权转移给目标变量，同时原变量成为未初始化的了，也不再能被使用了。

## Copy Type
当一个类型实现了 `Copy` trait 后，该类型的变量在赋值时，进行的是复制的操作，而不是
转移（move）操作。

## Rc, Arc
引用计数指针，其包含的值都被分配在了堆内存上，类似于 Box 指针这样的。
除此之外，在堆内存的头部，还存放着被引用的次数（ref counting），这个是 Box 没有的。

